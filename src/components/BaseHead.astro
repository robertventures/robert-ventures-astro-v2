---
import "../styles/global.css";
import favicon from "../images/logo-favicon.svg";

const canonicalURL = new URL(Astro.url.pathname, Astro.site);

const {
  title,
  description,
  image = "/images/svg/rv-logo.svg",
  rtkCampaignId = "",
} = Astro.props;
---



<!-- Sitemap -->
<link rel="sitemap" href="/sitemap-index.xml" />

<!-- Global Metadata -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<meta name="apple-mobile-web-app-title" content="Robert Ventures" />
<link rel="manifest" href="/site.webmanifest" />
<meta name="generator" content={Astro.generator} />

<!-- Canonical URL -->
<link rel="canonical" href={canonicalURL} />

<!-- SEO Meta Tags -->
<title>{title}</title>
<meta name="description" content={description} />
<meta
  name="keywords"
  content="investment, wealth management, real estate, technology assets, fixed-rate returns, APY"
/>
<meta name="author" content="Robert Ventures" />

<!-- Open Graph Meta Tags -->
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:url" content={canonicalURL} />
<meta property="og:type" content="website" />
<meta property="og:image" content={image} />

<!-- Twitter Card Meta Tags -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content={title} />
<meta name="twitter:description" content={description} />
<meta name="twitter:image" content={image} />


<!-- Google Fonts: Roboto & Roboto Serif -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&family=Roboto+Serif:ital,opsz,wght@0,8..144,100..900;1,8..144,100..900&display=swap" rel="stylesheet">

<!-- GSAP -->
<script>
    window.gsapLoaded = false;
    function loadGSAP() {
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js';
        script.onload = function() {
            window.gsapLoaded = true;
            // Dispatch custom event when GSAP is loaded
            window.dispatchEvent(new Event('gsapLoaded'));
        };
        document.head.appendChild(script);
    }
    loadGSAP();
</script>

<link rel="preload" href="/images/svg/waves.svg" as="image" />



<!-- GOOGLE TAG MANAGER -->
{Astro.site.hostname === "robertventures.com" && (
  <script src="/scripts/gtm.js" defer></script>
)}
<!-- GOOGLE TAG MANAGER -->

<!-- META PIXEL (loaded directly for reliability — not dependent on GTM) -->
{Astro.site.hostname === "robertventures.com" && (
  <script is:inline>
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
    n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}
    (window,document,'script','https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '652212003052612');
    fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=652212003052612&ev=PageView&noscript=1" /></noscript>
)}
<!-- META PIXEL -->

<!-- CHATBOT -->
<!-- {
  !["questions", "access", "webinar", "webinar-thank-you"].some((path) =>
    new RegExp(`/${path}(/|$)`).test(Astro.url.pathname),
  ) && (
    <script>
      window.addEventListener('load', () => {
        const script = document.createElement('script');
        script.src = '/scripts/chatbot.js';
        script.defer = true;
        document.body.appendChild(script);
      });
    </script>
  )
} -->
<!-- CHATBOT -->

<!-- EVENTS HANDLER -->
<script src="/scripts/analytics/GA4ClarityTriggers.js" async></script>
<script src="/scripts/analytics/scrollDepthTracking.js" defer></script>
<script src="/scripts/analytics/ctaTracking.js" defer></script>
<!-- EVENTS HANDLER -->

<!-- userAttribution.js: Captures user's IP address and main UTM parameters (utm_source, utm_medium, utm_campaign, utm_content, utm_term, utm_id) and stores them in localStorage for attribution and analytics. -->
<script src="/scripts/userAttribution.js" defer></script>

<!-- deviceDetection.js: Detects device type (desktop, ios, android, mobile) and stores it in localStorage for analytics and attribution. -->
<script src="/scripts/deviceDetection.js" defer></script>
<!-- EVENTS HANDLER -->

<!-- REDTRACK — captures RTK click ID on every page for ad attribution -->
<!-- 1. Immediately grabs clickid from URL and saves to localStorage (instant, never lost) -->
<!-- 2. Loads uniclick.js via first-party proxy (/rtk/*) for full RedTrack attribution -->
<script is:inline define:vars={{ rtkCampaignId }}>
  (function () {
    // Immediate fallback: grab clickid from URL before anything else
    try {
      var params = new URLSearchParams(window.location.search);
      var clickid = params.get("clickid");
      if (clickid) {
        localStorage.setItem("rtk_click_id", clickid);
      }
    } catch (e) {}

    // Load uniclick.js via first-party proxy
    if (window.__rtkUniclickInit) return;
    window.__rtkUniclickInit = true;
    var host = window.location.hostname.replace(/^www\./, "");
    var script = document.createElement("script");
    script.src =
      "/rtk/uniclick.js?attribution=lastpaid&clickid=clickid&cookiedomain=" +
      encodeURIComponent(host) +
      "&cookieduration=90&defaultcampaignid=" + encodeURIComponent(rtkCampaignId) +
      "&regviewonce=false";
    script.defer = true;
    document.head.appendChild(script);
  })();
</script>
